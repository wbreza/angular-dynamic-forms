!function(e){"use strict";e.module("dynamic-forms",[])}(angular),function(){"use strict";function e(e,n,t,r){return{restrict:"E",replace:!0,require:"?^dynamicForm",scope:{schema:"=",model:"=ngModel"},controller:"dynamicEditorController",controllerAs:"editor",link:function(a,i,o,m){m&&m.setupSchema(a.schema);var l=t.isComplex(a.schema),s=n.getEditorTemplate(a.schema),c=angular.element(s);l&&(a.schema.format=null,"object"!==a.schema.type||a.model||(a.model={})),i.replaceWith(c),r.applyRules(c,a.schema),e(c)(a),a.form=c.controller("form"),!a.form&&c[0].querySelector&&(a.form=angular.element(c[0].querySelector(".ng-form")).controller("form"))}}}function n(e){var n=this,t=[];n.getProperties=function(){if(t.length>0)return t;for(var n in e.schema.properties){var r=angular.extend({},e.schema.properties[n],{name:n});t.push(r)}return t},n.isValid=function(){return e.form.$valid},n.hasError=function(){return e.form.$invalid&&e.form.$dirty}}angular.module("dynamic-forms").directive("dynamicEditor",["$compile","dynamicTemplates","jsonSchema","validation",e]).controller("dynamicEditorController",["$scope",n])}(),function(){"use strict";function e(e){var n=this;n.showError=function(){var n=e.formField;return n&&n.$invalid&&n.$dirty},n.showSuccess=function(){var n=e.formField;return n&&n.$valid&&n.$dirty},n.hasError=function(){var n=e.formField;return n.errorMessage&&n.$dirty},n.hasSuccess=function(){var n=e.formField;return n.$valid&&(e.model||n.$dirty)}}function n(e,n,t){return{restrict:"E",replace:!0,require:"?^dynamicForm",controller:"dynamicFieldController",controllerAs:"field",link:function(n,r,a,i){var o=i?i.getFieldTemplate(n.schema.fieldType):t.getFieldTemplate(n.schema),m=angular.element(o);r.replaceWith(m),e(m)(n)}}}angular.module("dynamic-forms").controller("dynamicFieldController",["$scope",e]).directive("dynamicField",["$compile","validation","dynamicTemplates",n])}(),function(){"use strict";function e(e,n){return{restrict:"E",replace:!0,transclude:!0,scope:{schema:"=",model:"=ngModel",submit:"&"},controller:"dynamicFormController",controllerAs:"dynamicForm",link:function(t,r,a,i,o){var m=e.getFormTemplate(t.schema),l=angular.element(m);r.append(l),n(l,o)(t),t.form=l.controller("form"),t.form||(t.form=l.find("form").controller("form"))}}}function n(e,n,t){var r=this;r.onSubmit=function(){e.submit({$form:e.form,$model:e.model})},r.getFieldTemplate=function(t){return n.getFieldTemplate(t||e.schema.format||"default")},r.setupSchema=function(n){angular.isDefined(n.$ref)&&t.extend(n,e.schema)}}angular.module("dynamic-forms").directive("dynamicForm",["dynamicTemplates","$compile",e]).controller("dynamicFormController",["$scope","dynamicTemplates","jsonSchema",n])}(),function(){"use strict";function e(e,n,t,r){return{restrict:"E",replace:!0,require:"?^form",link:function(a,i,o,m){var l=a.schema.name+"-"+a.$id,s=e.getTemplate("editors",a.schema.format,a.schema.type,"string");s=t(s)(a);var c=angular.element(s);c.attr({id:l,name:l}),r.applyRules(c,a.schema),i.replaceWith(c),n(c)(a),m&&(a.form=m,a.formField=m[l],a.formField&&r.monitorField(a,a.schema,a.formField))}}}angular.module("dynamic-forms").directive("dynamicInput",["dynamicTemplates","$compile","$interpolate","validation",e])}(),function(e){"use strict";function n(e){return{restrict:"E",replace:!0,require:["?^form","ngModel"],transclude:!0,template:"<section ng-transclude></section>",controller:"dynamicListController",controllerAs:"dynamicList",link:function(n,t,r,a){var i=a[0],o=a[1];i&&(n.form=i,o.$name=n.schema.name+"-"+n.$id,i.$addControl(o),n.formField=i[o.$name],n.formField&&e.monitorField(n,n.schema,n.formField)),n.$on("$destroy",function(){i.$removeControl(o)})}}}function t(n){function t(){if(n.model===e&&(n.model=[]),angular.isDefined(n.schema.minItems)&&n.model.length<n.schema.minItems)for(var t=n.model.length;t<n.schema.minItems;t++)r.addItem()}var r=this;r.addItem=function(){n.model.push({})},r.removeItem=function(e,t){return n.model.splice(t,1)},r.canAddItem=function(){return!angular.isDefined(n.schema.maxItems)||n.model.length<n.schema.maxItems},r.canRemoveItem=function(){return!angular.isDefined(n.schema.minItems)||n.model.length>n.schema.minItems},t()}angular.module("dynamic-forms").directive("dynamicList",["validation",n]).controller("dynamicListController",["$scope",t])}(),function(){"use strict";function e(){return{restrict:"A",require:"?ngModel",link:function(e,n,t,r){if(r){var a=parseInt(t.maxItems,10);if(!isNaN(a)){var i=function(e){var n=!!(e&&e.length<=a);return r.$setValidity("maxitems",n),e};e.$watchCollection(t.ngModel,function(e){angular.isDefined(e)&&i(r.$modelValue)}),r.$formatters.push(i),r.$parsers.unshift(i)}}}}}angular.module("dynamic-forms").directive("maxItems",[e])}(),function(){"use strict";function e(){return{restrict:"A",require:"?ngModel",link:function(e,n,t,r){if(r){var a=parseInt(t.minItems,10);if(!isNaN(a)){var i=function(e){var n=!!(e&&e.length>=a);return r.$setValidity("minitems",n),e};e.$watchCollection(t.ngModel,function(e){angular.isDefined(e)&&i(r.$modelValue)}),r.$formatters.push(i),r.$parsers.unshift(i)}}}}}angular.module("dynamic-forms").directive("minItems",[e])}(),function(){"use strict";function e(e,n){function r(e){if(!e||e.length<1)return null;var n=e[0];return angular.isString(n)?n:n.format||n.type}function a(n){var r;if(arguments.length<2)return null;for(var a=1;a<arguments.length;a++){for(var i=arguments[a],o=0;o<t.length;o++){var m=t[o]+"/"+n+"/"+i+".html";if(r=e.get(m))break}if(r)break}return r}function i(e){return a("forms",e.format,e.type,"default")}function o(e){var t=n.isComplex(e);return t?a("editors",e.format,e.type,"object"):a("editors","property")}function m(){var e=r(arguments);return a("fields",e,"default")}return{getTemplate:a,getFormTemplate:i,getEditorTemplate:o,getFieldTemplate:m}}function n(){function n(e){return"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e}function r(e,r){angular.isDefined(r)||(r=t.length),t.indexOf(e)===-1&&t.splice(r,0,n(e))}function a(){t.length=0}function i(){r("/app/dynamic-forms/views")}function o(){return t}function m(){l.$get=["$templateCache","jsonSchema",e],l.registerTemplatePath=r,l.clearTemplatePaths=a,l.getTemplatePaths=o,i()}var l=this;m()}var t=[];angular.module("dynamic-forms").provider("dynamicTemplates",n)}(),function(){"use strict";function e(){function e(e){return"object"===e.type||"array"===e.type||e.properties&&Object.keys(e.properties).length>0||!1}function n(e){return o[e]}function t(e){if(!e.id)throw new Error("Schema does not specify an ID attribute");o[e.id]=e}function r(e,t){if(!angular.isDefined(e.$ref))return e;var r="#"===e.$ref[0]?a(e.$ref,t):n(e.$ref);return r&&angular.extend(e,r),e}function a(e,n){for(var t=e.substr(2).split("/"),r=n,a=0;a<t.length;a++)if(r=r[t[a]],!angular.isDefined(r))return null;return r}function i(){o={}}var o={};return{isComplex:e,get:n,register:t,extend:r,clear:i}}angular.module("dynamic-forms").factory("jsonSchema",[e])}(),function(){"use strict";function e(){function e(e,n){"undefined"==typeof l[e]&&(l[e]={});var t=angular.extend(l[e],{validator:e},n,{name:e});return s[t.validator]=t,t}function n(e,n){for(var t in n){var r=l[t];r&&angular.isFunction(r.link)&&r.link(e,n[t],n)}}function t(e,n,t){e.errorMessage=null,e.$watch(function(){if(!t.$invalid)return void(e.errorMessage=null);for(var a in t.$error)if(t.$error[a]===!0){e.errorMessage=r(n,a);break}})}function r(e,n){var t,r=s[n];return r&&(t=e.messages&&e.messages[r.name]||r.message),t||"Enter a valid value"}function a(){return l}function i(e){return"object"==typeof e?e.value:e}function o(){e("required",{link:function(e){e.attr("required","required")},message:"Field is required"}),e("minLength",{validator:"minlength",link:function(e,n){var t=i(n);"number"==typeof t&&e.attr("ng-minlength",i(n))},message:"Value is less than the allowed length"}),e("maxLength",{validator:"maxlength",link:function(e,n){var t=i(n);"number"==typeof t&&e.attr("ng-maxlength",i(n))},message:"Value is greater than the allowed length"}),e("pattern",{link:function(e,n){var t=n instanceof RegExp?n:n.value;e.attr("ng-pattern",t)},message:"Value does not match the allowed pattern"}),e("minimum",{validator:"min",link:function(e,n){var t=i(n);"number"==typeof t&&e.attr("min",t)},message:"Value is less than the allowed value"}),e("maximum",{validator:"max",link:function(e,n){var t=i(n);"number"==typeof t&&e.attr("max",t)},message:"Value is greater than the allowed value"}),e("range",{link:function(e,n,t){t.minimum=n.minimum,t.maximum=n.maximum,l.minimum.link(e,t.minimum,t),l.maximum.link(e,t.maximum,t)},message:"Value is not within the expected range"}),e("minItems",{validator:"minitems",link:function(e,n){var t=i(n);"number"==typeof n&&e.attr("data-min-items",t)},message:"Number of items is less than the allowed value"}),e("maxItems",{validator:"maxitems",link:function(e,n){var t=i(n);"number"==typeof n&&e.attr("data-max-items",t)},message:"Number of items is greater than the allowed value"}),c.registerValidator("email",{message:"Enter a valid email address"}),c.registerValidator("url",{message:"Enter a valid url"}),c.registerValidator("number",{message:"Enter a valid number"}),c.registerValidator("date",{message:"Enter a valid date"})}function m(){c.$get=[function(){return{applyRules:n,monitorField:t}}],c.registerValidator=e,c.getValidators=a,o()}var l={},s={},c=this;m()}angular.module("dynamic-forms").provider("validation",e)}(),angular.module("dynamic-forms").run(["$templateCache",function(e){e.put("/app/dynamic-forms/views/editors/array.html",'\n<dynamic-list data-schema="schema" ng-model="model">\n  <p data-ng-show="formField.$error.message" class="text-danger">{{formField.$error.message}}</p>\n  <button ng-click="dynamicList.addItem()" ng-disabled="!dynamicList.canAddItem()" type="button" class="btn btn-default btn-xs">Add Item</button>\n  <ul class="list-group">\n    <li ng-repeat="item in model" class="list-group-item">\n      <button ng-click="dynamicList.removeItem(item, $index)" ng-disabled="!dynamicList.canRemoveItem()" type="button" class="btn btn-default btn-xs">Remove Item</button>\n      <div>\n        <dynamic-editor data-schema="schema.items" ng-model="item" data-form="form"></dynamic-editor>\n      </div>\n    </li>\n  </ul>\n</dynamic-list>'),e.put("/app/dynamic-forms/views/editors/bool.html",'\n<input type="checkbox" ng-checked="model" ng-model="model"/>'),e.put("/app/dynamic-forms/views/editors/date.html",'\n<input type="date" ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/dropdown.html",'\n<select ng-options="{{schema.bindingExpression}}" ng-model="model" class="form-control"></select>'),e.put("/app/dynamic-forms/views/editors/email.html",'\n<input type="email" ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/integer.html",'\n<input type="number" ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/multilineText.html",'\n<textarea rows="6" ng-model="model" class="form-control"></textarea>'),e.put("/app/dynamic-forms/views/editors/number.html",'\n<input type="number" data-ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/object.html",'\n<div data-ng-repeat="property in editor.getProperties() | orderBy:\'index\' track by property.name">\n  <dynamic-editor ng-model="model[property.name]" data-schema="property"></dynamic-editor>\n</div>'),e.put("/app/dynamic-forms/views/editors/password.html",'\n<input type="password" data-ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/property.html",'\n<dynamic-field ng-model="model" data-schema="schema"></dynamic-field>'),e.put("/app/dynamic-forms/views/editors/richText.html",'\n<textarea rows="8" data-ng-model="model" class="form-control"></textarea>'),e.put("/app/dynamic-forms/views/editors/section.html",'\n<div ng-class="{\'panel-danger\':editor.hasError(), \'panel-success\':editor.isValid()}" ng-form="ng-form" class="panel panel-default">\n  <div class="panel-heading">{{schema.title}}</div>\n  <div class="panel-body">\n    <p>{{schema.description}}</p>\n    <dynamic-editor data-schema="schema" ng-model="model"></dynamic-editor>\n  </div>\n</div>'),e.put("/app/dynamic-forms/views/editors/string.html",'\n<input type="text" data-ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/editors/uri.html",'\n<input type="url" data-ng-model="model" class="form-control"/>'),e.put("/app/dynamic-forms/views/fields/checkbox.html",'\n<div class="checkbox">\n  <label>\n    <dynamic-input data-schema="schema" ng-model="model">{{schema.title}}</dynamic-input>\n    <p ng-show="field.hasError()" class="text-danger">{{field.errorMessage}}</p>\n  </label>\n</div>'),e.put("/app/dynamic-forms/views/fields/default.html",'\n<div ng-class="{\'has-error\': field.hasError(), \'has-success\': field.hasSuccess()}" class="form-group has-feedback">\n  <label class="control-label">{{schema.title}} </label><span ng-show="schema.required" class="required">* </span><span ng-show="schema.description" title="{{schema.description}}" class="glyphicon glyphicon-info-sign"></span>\n  <dynamic-input data-schema="schema" ng-model="model"></dynamic-input><span ng-class="{\'glyphicon-ok\': field.showSuccess(), \'glyphicon-remove\': field.showError()}" class="glyphicon form-control-feedback"></span>\n  <p data-ng-show="field.hasError()" class="text-danger">{{field.errorMessage}}</p>\n</div>'),e.put("/app/dynamic-forms/views/fields/horizontal.html",'\n<div class="form-group">\n  <label class="control-label col-sm-2">{{schema.title}}</label><span ng-show="schema.required" class="required">*</span><span ng-show="schema.description" title="{{schema.description}}" class="glyphicon glyphicon-info-sign"></span>\n  <div class="col-sm-10">\n    <dynamic-input data-schema="schema" ng-model="model"></dynamic-input><span ng-class="{\'glyphicon-ok\': field.showSuccess(), \'glyphicon-remove\': field.showError()}" class="glyphicon form-control-feedback"></span>\n    <p ng-show="field.hasError()" class="text-danger">{{field.errorMessage}}</p>\n  </div>\n</div>'),e.put("/app/dynamic-forms/views/forms/default.html",'\n<article>   \n  <form role="form" ng-submit="dynamicForm.onSubmit()" novalidate="novalidate">\n    <dynamic-editor data-schema="schema" ng-model="model"></dynamic-editor>\n    <section data-ng-transclude="data-ng-transclude"></section>\n  </form>\n</article>'),e.put("/app/dynamic-forms/views/forms/horizontal.html",'\n<article>\n  <h1>{{schema.title}}</h1>\n  <h4>{{schema.description}}</h4>\n  <hr/>\n  <form role="form" ng-submit="form.onSubmit(dynamicForm)" novalidate="novalidate" class="form-horizontal">\n    <dynamic-editor data-schema="schema" ng-model="model"></dynamic-editor>\n    <div class="form-group">\n      <div class="col-sm-2"></div>\n      <div class="col-sm-10">\n        <section ng-transclude="ng-transclude"></section>\n      </div>\n    </div>\n  </form>\n</article>')}]);